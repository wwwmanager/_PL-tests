# Комплексный план миграции на Backend

**Дата обновления**: 2025-12-07

Этот план описывает шаги по полному переводу приложения с `mockApi` на реальный Backend API.

---

## Фаза 1: Основные системы и справочники (✅ 100% Готово)
**Цель**: Убедиться, что все основные сущности хранятся в Postgres.

| Компонент | Статус |
|---|---|
| Аутентификация | ✅ Вход/Выход, JWT, RBAC |
| Путевые листы | ✅ CRUD, State Machine |
| Бланки | ✅ Партии, Материализация, Выдача |
| Маршруты | ✅ CRUD |
| Склады | ✅ CRUD, Движения |
| Организации | ✅ Список |
| Сотрудники | ✅ CRUD, `employeeApi.ts` |
| Транспорт | ✅ CRUD, `vehicleApi.ts` |

---

## Фаза 2: Администрирование (✅ 100% Готово)
**Цель**: Позволить Администратору управлять пользователями и настройками через Backend.

| Задача | Статус |
|---|---|
| Users API (`/api/users`) | ✅ `userApi.ts`, `UserManagement.tsx` |
| Roles API (`/api/roles`) | ✅ `roleApi.ts`, `RoleManagement.tsx` |
| Settings API (`/api/settings`) | ✅ `settingsApi.ts`, `Admin.tsx`, `SeasonSettingsModal.tsx` |

---

## Фаза 3: Дашборд и Отчеты (✅ 100% Готово)
**Цель**: Перенести тяжелые агрегации данных на Backend.

| Задача | Статус |
|---|---|
| Dashboard Stats (`/api/dashboard/stats`) | ✅ `dashboardService.ts`, `dashboardApi.ts` |
| Dashboard Issues (`/api/dashboard/issues`) | ✅ Истекающие документы |
| Reports (`Reports.tsx`) | ✅ Мигрирован на реальные API |
| Pre-Trip Report | ✅ Очищен от mockApi |

---

## Фаза 4: Рефакторинг и Очистка (⏳ В ПРОГРЕССЕ)
**Цель**: Устранить технический долг.

> ⚠️ **Breaking Change**: Driver Mode удалён. Приложение работает только с Backend API.

| Задача | Статус | Описание |
|---|---|---|
| API Фасады | [/] | Удалить проверки `shouldUseRealApi` |
| mockApi.ts | [ ] | Удалить файл и тесты |
| Валидация | [—] | Отложено: Унифицировать Zod |
| E2E тесты | [ ] | Обновить для работы с реальным Backend |
| Виртуализация | [—] | Отложено: Lazy loading для больших списков |

---

## Итоговый прогресс

```
Фаза 1 [████████████████████] 100%
Фаза 2 [████████████████████] 100%
Фаза 3 [████████████████████] 100%
Фаза 4 [██░░░░░░░░░░░░░░░░░░]  10%
────────────────────────────────
Общий прогресс:              ~78%
```

